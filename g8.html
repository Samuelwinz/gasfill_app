<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GasFill — Fast, Safe & Premium Cylinder Delivery</title>
  <meta name="description" content="GasFill — premium cylinder delivery and refill. SPA demo with dashboard, orders and product catalog."/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6f8fb;
      --card:#ffffff;
      --muted:#60708a;
      --accent1:#0ea5a4;
      --accent2:#0b5ed7;
      --accent3:#f97316;
      --glass: rgba(255,255,255,0.7);
      
      /* Enhanced Color Palette */
      --primary-50: #eff6ff;
      --primary-100: #dbeafe;
      --primary-500: #3b82f6;
      --primary-600: #2563eb;
      --primary-700: #1d4ed8;
      
      --success-50: #f0fdf4;
      --success-500: #22c55e;
      --success-600: #16a34a;
      --warning-50: #fefce8;
      --warning-500: #eab308;
      --error-50: #fef2f2;
      --error-500: #ef4444;
      
      /* Enhanced Spacing & Shadows */
      --space-xs: 0.25rem;
      --space-sm: 0.5rem;
      --space-md: 1rem;
      --space-lg: 1.5rem;
      --space-xl: 2rem;
      
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
      
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      background:linear-gradient(180deg,#f3f6fb,#fbfdff);
      color:#0f172a;
      display:flex;
      flex-direction:column;
      min-height:100vh;
    }

    /* --- App shell --- */
    .app{width:100%;max-width:1200px;margin:0 auto;padding:20px;flex:1;display:flex;flex-direction:column}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:8px 0;position:relative}
    .brand{display:flex;gap:14px;align-items:center}
    .logo{
      width:56px;height:56px;border-radius:12px;
      background:linear-gradient(135deg,var(--accent2),var(--accent1));
      display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:18px;
      box-shadow:0 8px 30px rgba(11,94,215,0.12)
    }
    .brand h1{margin:0;font-size:1.2rem}
    nav{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    nav a{padding:10px 14px;border-radius:10px;text-decoration:none;color:var(--muted);font-weight:600;min-height:44px;min-width:44px;display:flex;align-items:center;justify-content:center}
    nav a.active{background:#fff;border:1px solid #eef6ff;color:var(--accent2);box-shadow:0 6px 20px rgba(11,94,215,0.06)}
    .cta{background:linear-gradient(90deg,var(--accent2),#0b6ef0);color:#fff;padding:10px 14px;border-radius:10px;font-weight:800;box-shadow:0 10px 40px rgba(11,94,215,0.12);min-height:44px;min-width:44px;border:none;cursor:pointer}
    
    /* Hamburger menu */
    .hamburger{display:none;flex-direction:column;gap:4px;background:none;border:none;cursor:pointer;padding:10px;min-height:44px;min-width:44px;justify-content:center;align-items:center}
    .hamburger span{display:block;width:24px;height:3px;background:var(--accent2);border-radius:2px;transition:all 0.3s}
    .hamburger.active span:nth-child(1){transform:rotate(45deg) translate(6px,6px)}
    .hamburger.active span:nth-child(2){opacity:0}
    .hamburger.active span:nth-child(3){transform:rotate(-45deg) translate(6px,-6px)}

    /* content layout */
    main{flex:1;margin-top:12px}
    section{display:none}
    section.active{display:block}

    .hero{
      display:flex;gap:18px;align-items:center;padding:20px;border-radius:14px;background:linear-gradient(180deg,#fff,#fbfdff);box-shadow:0 18px 40px rgba(12,40,80,0.06)
    }
    .hero .text h2{margin:0 0 8px 0;font-size:1.6rem;line-height:1.3}
    .hero .text p{margin:0;color:var(--muted);line-height:1.5}

    /* grids/cards */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .card{background:var(--card);padding:14px;border-radius:12px;border:1px solid #f1f5f9;box-shadow:0 8px 28px rgba(12,40,80,0.04);transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1)}
    .card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    
    .product-card{display:flex;flex-direction:column;align-items:center;gap:10px;padding:18px;text-align:center;position:relative;overflow:hidden}
    .product-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--accent2),var(--accent1));transform:scaleX(0);transition:transform 0.3s ease}
    .product-card:hover::before{transform:scaleX(1)}
    .product-card:hover{transform:translateY(-8px);box-shadow:var(--shadow-xl);border-color:#e2e8f0}
    
    .product-card img{width:120px;height:120px;object-fit:contain;border-radius:8px}
    .product-card button{min-height:44px;min-width:120px;padding:12px 16px;background:linear-gradient(135deg,var(--accent2),var(--primary-600));color:#fff;border:none;border-radius:var(--radius-lg);cursor:pointer;font-weight:600;transition:all 0.2s ease;box-shadow:var(--shadow-md);position:relative;overflow:hidden}
    .product-card button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left 0.5s ease}
    .product-card button:hover::before{left:100%}
    .product-card button:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    .product-card button:active{transform:scale(0.95)}
    
    .product-status{position:absolute;top:var(--space-sm);right:var(--space-sm);padding:var(--space-xs) var(--space-sm);border-radius:var(--radius-md);font-size:0.75rem;font-weight:600}
    .product-status.available{background:var(--success-50);color:var(--success-600);border:1px solid var(--success-200)}
    .product-status.low-stock{background:var(--warning-50);color:var(--warning-600);border:1px solid var(--warning-200)}
    
    .price{font-weight:800;color:var(--accent2);font-size:1.1rem}
    .original-price{text-decoration:line-through;color:var(--muted);font-size:0.9rem;margin-left:var(--space-xs)}
    .small{font-size:0.92rem;color:var(--muted)}

    /* responsive */
    @media (max-width:1000px){ 
      .grid{grid-template-columns:repeat(2,1fr)} 
      .product-card img{width:100px;height:100px} 
    }
    @media (max-width:768px){
      .hamburger{display:flex}
      nav{
        position:absolute;
        top:100%;
        left:0;
        right:0;
        background:#fff;
        flex-direction:column;
        align-items:stretch;
        box-shadow:0 8px 24px rgba(12,40,80,0.1);
        border-radius:12px;
        margin-top:8px;
        padding:12px;
        max-height:0;
        overflow:hidden;
        transition:max-height 0.3s ease-out;
        z-index:100;
      }
      nav.mobile-open{max-height:600px;padding:12px}
      nav a{justify-content:flex-start;width:100%}
      nav .cta{margin-left:0!important}
    }
    @media (max-width:640px){ 
      .grid{grid-template-columns:1fr} 
      .hero{flex-direction:column;align-items:flex-start}
      .hero .text h2{font-size:1.3rem}
      .hero > div:last-child{width:100%;max-width:300px}
      .hero svg{width:100%;height:auto}
      .app{padding:12px}
      button,a.cta,.product-card button{font-size:0.95rem;padding:12px 16px}
    }

    /* forms */
    form input,form textarea,form select{width:100%;padding:12px;border-radius:10px;border:1px solid #e6eef8;font-size:0.95rem;min-height:44px}
    form button{min-height:44px;min-width:120px;cursor:pointer}
    .row{display:flex;gap:10px}
    .row .col{flex:1}
    @media (max-width:640px){
      .row{flex-direction:column}
    }

    /* footer sticky */
    footer{background:linear-gradient(90deg,#0b1220,#0b2a4d);color:#fff;padding:24px;margin-top:20px;border-top-left-radius:12px;border-top-right-radius:12px;flex-shrink:0}
    footer .inner{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
    footer a{color:rgba(255,255,255,0.85);text-decoration:none}

    /* cart floating */
    .cart-btn{position:fixed;right:18px;bottom:90px;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#fff;padding:12px 14px;border-radius:14px;box-shadow:0 12px 36px rgba(11,94,215,0.18);z-index:60;border:none;cursor:pointer;font-weight:800;min-height:44px;min-width:44px}
    .cart-count{background:#fff;color:var(--accent2);border-radius:999px;padding:4px 8px;margin-left:8px;font-weight:800}

    /* orders log / badges */
    .orders-log{display:flex;flex-direction:column;gap:10px}
    .order-row{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;border:1px solid #eef4ff;background:#fff;flex-wrap:wrap;gap:8px;transition:all 0.2s ease}
    .order-row:hover{background:#f8fafc;border-color:#cbd5e1;transform:translateX(4px)}
    
    .badge{padding:6px 10px;border-radius:999px;font-weight:700;min-height:32px;display:inline-flex;align-items:center;font-size:0.875rem}
    .badge-pending{background:var(--warning-50);color:var(--warning-600);border:1px solid var(--warning-200)}
    .badge-assigned{background:var(--primary-50);color:var(--primary-600);border:1px solid var(--primary-200)}
    .badge-in-transit{background:#eff6ff;color:#1e40af;border:1px solid #bfdbfe}
    .badge-nearby{background:#fef3c7;color:#92400e;border:1px solid #fde68a}
    .badge-delivered{background:var(--success-50);color:var(--success-600);border:1px solid var(--success-200)}
    .badge-cancelled{background:var(--error-50);color:var(--error-500);border:1px solid var(--error-200)}
    
    .order-tracking{display:flex;align-items:center;gap:var(--space-sm);font-size:0.875rem;color:var(--muted)}
    .rider-info{display:flex;align-items:center;gap:var(--space-xs);color:var(--accent2);font-weight:600}
    .eta-badge{background:#f0f9ff;color:#0369a1;padding:2px 6px;border-radius:4px;font-size:0.75rem}
    
    .muted-2{color:#64748b}

    /* utility */
    .center{text-align:center}
    button:not(.hamburger):not(.cart-btn){
      min-height:44px;
      padding:10px 16px;
      border-radius:8px;
      border:1px solid #e2e8f0;
      background:#fff;
      cursor:pointer;
      font-weight:600;
      transition:all 0.2s;
    }
    button:not(.hamburger):not(.cart-btn):hover{
      background:#f8fafc;
      transform:translateY(-1px);
    }
    button:not(.hamburger):not(.cart-btn):active{
      transform:translateY(0);
    }
    
    /* Enhanced Notifications & Feedback */
    .toast-notification{position:fixed;top:20px;right:20px;background:#fff;border-radius:var(--radius-lg);box-shadow:var(--shadow-xl);border:1px solid #e5e7eb;z-index:1000;animation:slideInRight 0.3s ease-out}
    .toast-content{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-md)}
    .toast-icon{font-size:1.25rem}
    .toast-message{font-weight:600;color:#374151}
    
    .cart-feedback-toast{position:fixed;bottom:120px;right:20px;background:var(--success-500);color:white;border-radius:var(--radius-lg);box-shadow:var(--shadow-xl);z-index:1000;animation:slideUp 0.3s ease-out}
    .feedback-content{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-md)}
    .feedback-button{background:rgba(255,255,255,0.2);border:none;color:white;padding:var(--space-xs) var(--space-sm);border-radius:var(--radius-md);cursor:pointer;font-weight:600;transition:background 0.2s}
    .feedback-button:hover{background:rgba(255,255,255,0.3)}
    
    /* Loading States */
    .loading-skeleton{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0 50%,#f0f0f0 75%);background-size:200% 100%;animation:loading 1.5s infinite;border-radius:var(--radius-md)}
    .btn-loading{position:relative;color:transparent!important}
    .btn-loading::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:20px;height:20px;border:2px solid rgba(255,255,255,0.3);border-top:2px solid white;border-radius:50%;animation:spin 1s linear infinite}
    
    /* Cart Animations */
    .cart-added{animation:cartBounce 0.3s ease-out}
    .cart-updated{animation:cartPulse 0.3s ease-out}
    
    @keyframes slideInRight{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}
    @keyframes slideUp{from{opacity:0;transform:translateY(100px)}to{opacity:1;transform:translateY(0)}}
    @keyframes loading{0%{background-position:200% 0}100%{background-position:-200% 0}}
    @keyframes spin{0%{transform:translate(-50%,-50%) rotate(0deg)}100%{transform:translate(-50%,-50%) rotate(360deg)}}
    @keyframes cartBounce{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
    @keyframes cartPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
    
    /* Status Indicators with Icons */
    .status-indicator{display:inline-flex;align-items:center;gap:var(--space-xs);font-size:0.875rem;font-weight:500}
    .status-icon{width:8px;height:8px;border-radius:50%;animation:pulse 2s infinite}
    .status-icon.pending{background:var(--warning-500)}
    .status-icon.in-transit{background:var(--primary-500)}
    .status-icon.delivered{background:var(--success-500)}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo" aria-label="GasFill logo">GF</div>
        <div>
          <h1>GasFill</h1>
          <div class="small">Fast • Safe • Premium</div>
        </div>
      </div>

      <button class="hamburger" id="hamburgerBtn" aria-label="Toggle navigation menu" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <nav id="mainNav" aria-label="Main navigation">
        <a href="#" data-target="products" class="nav-link active" aria-label="View products">Products</a>
        <a href="#" data-target="order" class="nav-link" aria-label="Place an order">Order</a>
        <a href="#" data-target="bulk" class="nav-link" aria-label="Bulk orders">Bulk</a>
        <a href="#" data-target="safety" class="nav-link" aria-label="Safety information">Safety</a>
        <a href="#" data-target="contact" class="nav-link" aria-label="Contact us">Contact</a>
        <a href="#" data-target="orderNow" class="nav-link" aria-label="Quick order">Order Now</a>
        <a href="#" data-target="dashboard" class="nav-link" aria-label="View dashboard">Dashboard</a>
        <button class="cta" id="orderNowBtn" style="margin-left:10px" aria-label="Order now">Order Now</button>
      </nav>
    </header>

    <main>
      <!-- HERO / PRODUCTS -->
      <section id="products" class="active">
        <div class="hero card" role="region" aria-label="hero">
          <div style="flex:1" class="text">
            <h2>GasFill — Fast, safe cylinder delivery</h2>
            <p class="small">Order premium cylinders, exchange empties, or set up bulk deliveries for your business.</p>
            <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
              <button onclick="navigateTo('order')" class="cta" aria-label="Order a cylinder">Order Cylinder</button>
              <button onclick="navigateTo('bulk')" style="background:#fff;border:1px solid #eef6ff;padding:10px 12px;border-radius:10px" aria-label="Bulk and business orders">Bulk & Business</button>
            </div>
          </div>
          <div style="width:360px;display:flex;align-items:center;justify-content:center">
            <!-- simple illustrative SVG -->
            <svg width="220" height="140" viewBox="0 0 220 140" xmlns="http://www.w3.org/2000/svg">
              <rect x="6" y="20" width="140" height="100" rx="12" fill="#0b5ed7" opacity="0.12"/>
              <rect x="74" y="32" width="110" height="80" rx="10" fill="#0ea5a4" opacity="0.14"/>
              <g transform="translate(10,16)">
                <rect width="120" height="90" rx="10" fill="#fff"/>
                <rect x="14" y="12" width="92" height="20" rx="8" fill="url(#g1)"/>
                <g transform="translate(10,48)" fill="#0b5ed7">
                  <rect width="24" height="24" rx="4"/>
                  <rect x="32" width="24" height="24" rx="4"/>
                  <rect x="64" width="24" height="24" rx="4"/>
                </g>
              </g>
            </svg>
          </div>
        </div>

        <div style="margin-top:18px;display:flex;justify-content:space-between;align-items:center">
          <h2 style="margin:0">Popular Products</h2>
          <div class="small muted-2">Tap a product to add to cart</div>
        </div>

        <div class="grid" style="margin-top:12px">
          <!-- product objects -->
          <div class="card product-card" data-id="6kg" data-name="6kg Cylinder" data-price="120">
            <div class="product-status available">✅ In Stock</div>
            <svg width="120" height="120" viewBox="0 0 64 64" aria-hidden="true" loading="lazy"><rect x="12" y="8" width="40" height="48" rx="6" fill="#f6f9ff"/><rect x="22" y="4" width="20" height="6" rx="2" fill="#0b5ed7"/></svg>
            <div style="font-weight:700">6kg Cylinder</div>
            <div class="small">Portable & safe • Perfect for small households</div>
            <div class="price">₵120</div>
            <button onclick="addToCartEnhanced('6kg','6kg Cylinder',120)" aria-label="Add 6kg cylinder to cart">Add to cart</button>
          </div>

          <div class="card product-card" data-id="12kg" data-name="12.5kg Cylinder" data-price="220">
            <div class="product-status available">✅ In Stock</div>
            <svg width="120" height="120" viewBox="0 0 64 64" aria-hidden="true" loading="lazy"><rect x="10" y="6" width="44" height="52" rx="8" fill="#fdfaf6"/><rect x="22" y="4" width="20" height="6" rx="2" fill="#0ea5a4"/></svg>
            <div style="font-weight:700">12.5kg Cylinder</div>
            <div class="small">Household standard • Most popular choice</div>
            <div class="price">₵220</div>
            <button onclick="addToCartEnhanced('12kg','12.5kg Cylinder',220)" aria-label="Add 12.5kg cylinder to cart">Add to cart</button>
          </div>

          <div class="card product-card" data-id="37kg" data-name="37kg Cylinder" data-price="680">
            <div class="product-status low-stock">⚠️ Low Stock</div>
            <svg width="120" height="120" viewBox="0 0 64 64" aria-hidden="true" loading="lazy"><rect x="8" y="4" width="48" height="56" rx="10" fill="#fff7f0"/><rect x="22" y="6" width="20" height="8" rx="3" fill="#f97316"/></svg>
            <div style="font-weight:700">37kg Cylinder</div>
            <div class="small">Commercial grade • Restaurant & business use</div>
            <div class="price">₵680</div>
            <button onclick="addToCartEnhanced('37kg','37kg Cylinder',680)" aria-label="Add 37kg cylinder to cart">Add to cart</button>
          </div>

          <div class="card product-card" data-id="reg" data-name="Regulator" data-price="80">
            <div class="product-status available">✅ In Stock</div>
            <svg width="120" height="120" viewBox="0 0 64 64" aria-hidden="true" loading="lazy"><circle cx="32" cy="32" r="24" fill="#f0f9ff"/><rect x="28" y="26" width="8" height="12" rx="2" fill="#0b5ed7"/></svg>
            <div style="font-weight:700">Gas Regulator</div>
            <div class="small">Safety certified • High-quality brass</div>
            <div class="price">₵80</div>
            <button onclick="addToCartEnhanced('reg','Regulator',80)" aria-label="Add regulator to cart">Add to cart</button>
          </div>

          <div class="card product-card" data-id="hose" data-name="Gas Hose" data-price="45">
            <div class="product-status available">✅ In Stock</div>
            <svg width="120" height="120" viewBox="0 0 64 64" aria-hidden="true" loading="lazy"><path d="M10 32c8-10 40-12 44 0" stroke="#0ea5a4" stroke-width="4" fill="none"/></svg>
            <div style="font-weight:700">Gas Hose</div>
            <div class="small">High-pressure rated • 1.5m length</div>
            <div class="price">₵45</div>
            <button onclick="addToCartEnhanced('hose','Gas Hose',45)" aria-label="Add hose to cart">Add to cart</button>
          </div>

          <div class="card product-card" data-id="burner" data-name="Gas Burner" data-price="150">
            <div class="product-status available">✅ In Stock</div>
            <svg width="120" height="120" viewBox="0 0 64 64" aria-hidden="true" loading="lazy"><rect x="14" y="18" width="36" height="28" rx="6" fill="#fff8f0"/><circle cx="32" cy="32" r="6" fill="#f97316"/></svg>
            <div style="font-weight:700">Gas Burner</div>
            <div class="small">Stainless steel • Double ring burner</div>
            <div class="price">₵150</div>
            <button onclick="addToCartEnhanced('burner','Gas Burner',150)" aria-label="Add gas burner to cart">Add to cart</button>
          </div>
        </div>
      </section>

      <!-- ORDER single -->
      <section id="order">
        <div class="card">
          <h2>Place an Order</h2>
          <form id="singleOrderForm">
            <div class="row" style="margin-top:8px">
              <div class="col"><label>Full name</label><input id="o_name" required></div>
              <div class="col"><label>Phone (WhatsApp)</label><input id="o_phone" required></div>
            </div>
            <label style="margin-top:8px">Product</label>
            <select id="o_product">
              <option>12.5kg Cylinder — Refill</option>
              <option>5kg Cylinder — Refill</option>
              <option>37kg Cylinder — Commercial</option>
              <option>Empty Exchange</option>
            </select>

            <label style="margin-top:8px">Quantity</label>
            <input id="o_qty" type="number" min="1" value="1">

            <label style="margin-top:8px">Delivery address</label>
            <textarea id="o_address" rows="3" required></textarea>

            <div style="display:flex;gap:10px;margin-top:12px;align-items:center;flex-wrap:wrap">
              <button type="button" id="placeOrderBtn" class="cta" aria-label="Submit order">Submit Order</button>
              <div class="small muted-2">Or <button type="button" class="small" onclick="openWhatsAppOrder()" aria-label="Send order via WhatsApp">send via WhatsApp</button></div>
            </div>
            <div id="orderFeedback" class="small" style="margin-top:8px;color:green"></div>
          </form>
        </div>
      </section>

      <!-- BULK -->
      <section id="bulk">
        <div class="card">
          <h2>Bulk Orders & Business Supply</h2>
          <p class="small">Volume discounts, scheduled deliveries, and dedicated support for businesses.</p>

          <div style="margin-top:12px" class="grid">
            <div class="card">
              <h3>Standard Bulk Pack</h3>
              <p class="small">10 × 12.5kg cylinders, priority delivery</p>
              <p class="price">From ₵1,900</p>
              <button onclick="fillBulk('Standard')" aria-label="Request quote for standard bulk pack">Request Quote</button>
            </div>
            <div class="card">
              <h3>Restaurant Pack</h3>
              <p class="small">20 × 37kg cylinders, weekly delivery</p>
              <p class="price">From ₵12,800</p>
              <button onclick="fillBulk('Restaurant')" aria-label="Request quote for restaurant pack">Request Quote</button>
            </div>
            <div class="card">
              <h3>Retailer Pack</h3>
              <p class="small">Mixed cylinders + accessories</p>
              <p class="price">Custom pricing</p>
              <button onclick="fillBulk('Retailer')" aria-label="Request quote for retailer pack">Request Quote</button>
            </div>
          </div>

          <div style="margin-top:14px">
            <h4>Request a Quote</h4>
            <form id="bulkForm">
              <input id="b_company" placeholder="Company / Business name" />
              <input id="b_contact" placeholder="Contact phone / email" />
              <textarea id="b_details" placeholder="Tell us your monthly usage & preferred schedule"></textarea>
              <div style="display:flex;gap:8px;margin-top:8px"><button type="button" onclick="submitBulk()" aria-label="Send bulk quote request">Send Request</button></div>
              <div id="bulkFeedback" class="small" style="margin-top:8px;color:green"></div>
            </form>
          </div>
        </div>
      </section>

      <!-- SAFETY -->
      <section id="safety">
        <h2>Safety & Handling</h2>
        <div class="grid" style="margin-top:12px">
          <div class="card">
            <h3>Storage</h3>
            <p class="small">Keep cylinders upright in ventilated areas, away from heat and flames.</p>
          </div>
          <div class="card">
            <h3>Leak Detection</h3>
            <p class="small">Use soapy water — bubbles indicate a leak. Do not use flames to test.</p>
          </div>
          <div class="card">
            <h3>Installation</h3>
            <p class="small">Our certified technicians fit regulators and hoses on-site and run safety checks.</p>
          </div>
          <div class="card">
            <h3>Emergency</h3>
            <p class="small">If you smell gas: ventilate, evacuate, and call our emergency hotline immediately.</p>
          </div>
        </div>
      </section>

      <!-- CONTACT -->
      <section id="contact">
        <div class="card">
          <h2>Contact & Support</h2>
          <div class="grid" style="margin-top:12px">
            <div class="card">
              <h3>Hotline</h3>
              <p class="small">+233 201 022 153</p>
              <button onclick="callHotline()" aria-label="Call hotline">Call</button>
            </div>
            <div class="card">
              <h3>WhatsApp</h3>
              <p class="small">+233 201 022 153 (fastest)</p>
              <button onclick="openWhatsApp()" aria-label="Open WhatsApp">Open WhatsApp</button>
            </div>
            <div class="card">
              <h3>Email</h3>
              <p class="small">support@gasfill.example</p>
              <button onclick="composeEmail()" aria-label="Email us">Email Us</button>
            </div>
          </div>

          <div style="margin-top:14px">
            <h4>Send us a message</h4>
            <form id="contactForm">
              <input id="c_name" placeholder="Your name" />
              <input id="c_email" placeholder="Your email" />
              <textarea id="c_msg" placeholder="Message"></textarea>
              <div style="margin-top:8px"><button type="button" onclick="submitContact()" aria-label="Send message">Send Message</button></div>
              <div id="contactFeedback" class="small" style="margin-top:8px;color:green"></div>
            </form>
          </div>
        </div>
      </section>

      <!-- ORDER NOW quick -->
      <section id="orderNow">
        <div class="card center">
          <h2>Quick Order</h2>
          <p class="small">Select a product and place a one-click order.</p>
          <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center">
            <button onclick="oneClickOrder('12.5kg Cylinder',220)" aria-label="Quick order 12.5kg cylinder for 220">12.5kg — ₵220</button>
            <button onclick="oneClickOrder('6kg Cylinder',120)" aria-label="Quick order 6kg cylinder for 120">6kg — ₵120</button>
            <button onclick="oneClickOrder('37kg Cylinder',680)" aria-label="Quick order 37kg cylinder for 680">37kg — ₵680</button>
          </div>
          <div id="quickFeedback" class="small" style="margin-top:10px;color:green"></div>
        </div>
      </section>

      <!-- DASHBOARD -->
      <section id="dashboard">
        <div style="display:flex;gap:16px;flex-wrap:wrap">
          <div class="card" style="flex:1;min-width:220px">
            <h3>Orders Today</h3>
            <div id="statOrders" style="font-weight:800;font-size:1.4rem">0</div>
            <div class="small muted-2">Total orders recorded in this browser</div>
          </div>

          <div class="card" style="flex:1;min-width:220px">
            <h3>Pending Deliveries</h3>
            <div id="statPending" style="font-weight:800;font-size:1.4rem">0</div>
            <div class="small muted-2">Orders not yet delivered</div>
          </div>

          <div class="card" style="flex:1;min-width:220px">
            <h3>Revenue (simulated)</h3>
            <div id="statRevenue" style="font-weight:800;font-size:1.4rem">₵0</div>
            <div class="small muted-2">Sum of order totals stored locally</div>
          </div>
        </div>

        <div style="margin-top:14px">
          <h3>Recent Orders</h3>
          <div id="recentOrders" class="orders-log" style="margin-top:8px"></div>
        </div>
      </section>

    </main>

    <!-- Floating cart -->
    <button class="cart-btn" id="openCartBtn" title="Open cart" aria-label="Open shopping cart">Cart (<span id="cartCount">0</span>)</button>

    <!-- Cart Modal (simple) -->
    <div id="cartModal" style="display:none;position:fixed;inset:0;background:rgba(4,8,15,0.45);align-items:center;justify-content:center;z-index:80" role="dialog" aria-labelledby="cartTitle" aria-modal="true">
      <div style="width:100%;max-width:520px;background:#fff;border-radius:12px;padding:18px;box-shadow:0 16px 40px rgba(2,6,23,0.2);margin:20px">
        <div style="display:flex;align-items:center;justify-content:space-between"><h3 id="cartTitle" style="margin:0">Your Cart</h3><button onclick="closeCart()" class="small" aria-label="Close cart">Close</button></div>
        <div id="cartItems" style="margin-top:12px;display:flex;flex-direction:column;gap:10px"></div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
          <div class="small muted-2">Total</div><div id="cartTotal" style="font-weight:800">₵0</div>
        </div>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <button onclick="checkoutCart()" class="cta" aria-label="Checkout cart">Checkout</button>
          <button onclick="clearCart()" style="background:#fff;border:1px solid #eef6ff;padding:8px;border-radius:8px" aria-label="Clear cart">Clear</button>
        </div>
        <div id="cartFeedback" class="small" style="margin-top:8px;color:green"></div>
      </div>
    </div>

    <footer>
      <div class="inner">
        <div>
          <strong>GasFill</strong>
          <div class="small muted-2">Fast • Safe • Premium</div>
        </div>
        <div class="small">
          © 2025 GasFill • <a href="#privacy">Privacy</a> • <a href="#terms">Terms</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // -------------------------
    // Enhanced Utility Functions
    // -------------------------
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // -------------------------
    // Enhanced Cart Management System
    // -------------------------
    class EnhancedCartManager {
      static addToCart(id, name, price) {
        const cart = loadCart();
        const existingItem = cart.find(item => item.id === id);
        
        if (existingItem) {
          existingItem.qty++;
          this.showCartAnimation('updated');
        } else {
          cart.push({ 
            id, 
            name, 
            price, 
            qty: 1, 
            addedAt: new Date().toISOString(),
            category: this.getProductCategory(id)
          });
          this.showCartAnimation('added');
        }
        
        saveCart(cart);
        this.updateCartUI();
        this.showAddToCartFeedback(name);
        
        // Analytics tracking
        this.trackAddToCart(id, name, price);
      }
      
      static getProductCategory(id) {
        const categories = {
          '6kg': 'cylinders',
          '12kg': 'cylinders', 
          '37kg': 'cylinders',
          'reg': 'accessories',
          'hose': 'accessories',
          'burner': 'accessories'
        };
        return categories[id] || 'other';
      }
      
      static showAddToCartFeedback(productName) {
        const feedback = document.createElement('div');
        feedback.className = 'cart-feedback-toast';
        feedback.innerHTML = `
          <div class="feedback-content">
            <span class="feedback-icon">✅</span>
            <span class="feedback-text">${productName} added to cart!</span>
            <button onclick="openCart()" class="feedback-button">View Cart</button>
          </div>
        `;
        
        document.body.appendChild(feedback);
        setTimeout(() => feedback.remove(), 4000);
      }
      
      static showCartAnimation(action) {
        const cartBtn = document.getElementById('openCartBtn');
        cartBtn.classList.add(`cart-${action}`);
        setTimeout(() => cartBtn.classList.remove(`cart-${action}`), 300);
      }
      
      static trackAddToCart(id, name, price) {
        // Analytics tracking for business intelligence
        const analytics = JSON.parse(localStorage.getItem('gasfill_analytics_v1') || '[]');
        analytics.push({
          event: 'add_to_cart',
          productId: id,
          productName: name,
          price: price,
          timestamp: new Date().toISOString(),
          sessionId: this.getSessionId()
        });
        
        // Keep only last 100 events
        if (analytics.length > 100) {
          analytics.splice(0, analytics.length - 100);
        }
        
        localStorage.setItem('gasfill_analytics_v1', JSON.stringify(analytics));
      }
      
      static getSessionId() {
        let sessionId = sessionStorage.getItem('gasfill_session');
        if (!sessionId) {
          sessionId = 'sess_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          sessionStorage.setItem('gasfill_session', sessionId);
        }
        return sessionId;
      }
    }

    // -------------------------
    // Real-time Order Status Management
    // -------------------------
    class OrderStatusManager {
      static riders = [
        { id: 'rider_1', name: 'Kwame Asante', phone: '+233241234567', rating: 4.8, vehicle: 'Motorcycle' },
        { id: 'rider_2', name: 'Ama Osei', phone: '+233267890123', rating: 4.9, vehicle: 'Van' },
        { id: 'rider_3', name: 'Kofi Mensah', phone: '+233208765432', rating: 4.7, vehicle: 'Motorcycle' },
        { id: 'rider_4', name: 'Akosua Nimako', phone: '+233245678901', rating: 4.8, vehicle: 'Truck' }
      ];
      
      static initializeRealTimeUpdates() {
        // Simulate real-time updates every 30 seconds
        setInterval(() => {
          this.processOrderUpdates();
        }, 30000);
        
        // Initialize immediately
        this.processOrderUpdates();
      }
      
      static processOrderUpdates() {
        const orders = loadOrders();
        let hasUpdates = false;
        
        orders.forEach(order => {
          const timeSinceCreated = Date.now() - new Date(order.createdAt).getTime();
          const minutesElapsed = Math.floor(timeSinceCreated / 60000);
          
          // Simulate realistic order progression
          if (order.status === 'pending' && minutesElapsed > 2 && Math.random() > 0.6) {
            order.status = 'assigned';
            order.rider = this.assignBestRider(order);
            order.estimatedArrival = new Date(Date.now() + (25 + Math.random() * 10) * 60000).toISOString();
            hasUpdates = true;
            this.showStatusNotification(`Order ${order.id.slice(-6)} assigned to ${order.rider.name}!`);
          } else if (order.status === 'assigned' && minutesElapsed > 5 && Math.random() > 0.7) {
            order.status = 'picked_up';
            order.pickedUpAt = new Date().toISOString();
            hasUpdates = true;
            this.showStatusNotification(`Your order is on the way!`);
          } else if (order.status === 'picked_up' && minutesElapsed > 8 && Math.random() > 0.8) {
            order.status = 'in_transit';
            order.estimatedArrival = new Date(Date.now() + 10 * 60000).toISOString();
            hasUpdates = true;
          } else if (order.status === 'in_transit' && minutesElapsed > 12 && Math.random() > 0.9) {
            order.status = 'nearby';
            order.estimatedArrival = new Date(Date.now() + 3 * 60000).toISOString();
            hasUpdates = true;
            this.showStatusNotification(`Your rider is nearby! Please be available.`);
          }
        });
        
        if (hasUpdates) {
          saveOrders(orders);
          if (document.getElementById('dashboard').classList.contains('active')) {
            renderDashboard();
          }
        }
      }
      
      static assignBestRider(order) {
        // Simulate intelligent rider assignment
        const availableRiders = this.riders.filter(rider => Math.random() > 0.3);
        if (availableRiders.length === 0) return this.riders[0];
        
        // Select rider based on rating and vehicle suitability
        const bestRider = availableRiders.reduce((best, current) => {
          const currentScore = current.rating + (this.isVehicleSuitable(current.vehicle, order) ? 0.5 : 0);
          const bestScore = best.rating + (this.isVehicleSuitable(best.vehicle, order) ? 0.5 : 0);
          return currentScore > bestScore ? current : best;
        });
        
        return bestRider;
      }
      
      static isVehicleSuitable(vehicle, order) {
        const heavyItems = ['37kg'];
        const hasHeavyItems = order.items?.some(item => heavyItems.includes(item.id)) || 
                             order.product?.includes('37kg');
        
        return hasHeavyItems ? vehicle === 'Van' || vehicle === 'Truck' : true;
      }
      
      static showStatusNotification(message) {
        const toast = document.createElement('div');
        toast.className = 'toast-notification';
        toast.innerHTML = `
          <div class="toast-content">
            <span class="toast-icon">🚚</span>
            <span class="toast-message">${message}</span>
          </div>
        `;
        document.body.appendChild(toast);
        
        setTimeout(() => toast.remove(), 5000);
      }
      
      static getStatusDisplay(status) {
        const statusMap = {
          'pending': { text: 'Order Received', icon: '📋', class: 'badge-pending' },
          'assigned': { text: 'Rider Assigned', icon: '👤', class: 'badge-assigned' },
          'picked_up': { text: 'Picked Up', icon: '📦', class: 'badge-in-transit' },
          'in_transit': { text: 'On the Way', icon: '🚗', class: 'badge-in-transit' },
          'nearby': { text: 'Nearby (5 min)', icon: '📍', class: 'badge-nearby' },
          'delivered': { text: 'Delivered', icon: '✅', class: 'badge-delivered' },
          'cancelled': { text: 'Cancelled', icon: '❌', class: 'badge-cancelled' }
        };
        
        return statusMap[status] || statusMap['pending'];
      }
    }

    // -------------------------
    // Hamburger menu for mobile
    // -------------------------
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const mainNav = document.getElementById('mainNav');
    
    hamburgerBtn.addEventListener('click', () => {
      const isOpen = mainNav.classList.toggle('mobile-open');
      hamburgerBtn.classList.toggle('active');
      hamburgerBtn.setAttribute('aria-expanded', isOpen);
    });

    // Close menu when clicking nav link on mobile
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        if (window.innerWidth <= 768) {
          mainNav.classList.remove('mobile-open');
          hamburgerBtn.classList.remove('active');
          hamburgerBtn.setAttribute('aria-expanded', 'false');
        }
      });
    });

    // -------------------------
    // Simple SPA routing (no framework)
    // -------------------------
    navLinks.forEach(a=> a.addEventListener('click', e=>{
      e.preventDefault();
      const tgt = a.getAttribute('data-target');
      activateSection(tgt);
    }));
    document.getElementById('orderNowBtn').addEventListener('click', ()=> activateSection('orderNow'));

    function activateSection(id){
      document.querySelectorAll('section').forEach(s=> s.classList.remove('active'));
      const el = document.getElementById(id);
      if(!el) return;
      el.classList.add('active');
      // nav active class
      navLinks.forEach(a=> a.classList.toggle('active', a.getAttribute('data-target')===id));
      // update dashboard when shown
      if(id==='dashboard') renderDashboard();
      window.scrollTo({top:0,behavior:'smooth'});
    }
    function navigateTo(id){ activateSection(id); }

    // -------------------------
    // CART (localStorage) - Enhanced Version
    // -------------------------
    const CART_KEY = 'gasfill_cart_v1';
    const ORDERS_KEY = 'gasfill_orders_v1';

    function loadCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY) || '[]') }catch(e){ return [] } }
    function saveCart(items){ localStorage.setItem(CART_KEY, JSON.stringify(items)); updateCartUI() }

    // Enhanced addToCart function
    function addToCartEnhanced(id, name, price) {
      // Show loading state on button
      const button = event.target;
      const originalText = button.textContent;
      button.classList.add('btn-loading');
      button.disabled = true;
      
      // Simulate network delay for better UX
      setTimeout(() => {
        EnhancedCartManager.addToCart(id, name, price);
        
        // Restore button state
        button.classList.remove('btn-loading');
        button.disabled = false;
        button.textContent = originalText;
      }, 500);
    }

    // Keep backward compatibility
    function addToCart(id, name, price) {
      return addToCartEnhanced(id, name, price);
    }

    function updateCartUI(){
      const cart = loadCart();
      const count = cart.reduce((s,i)=>s+i.qty,0);
      const countEl = document.getElementById('cartCount');
      if (countEl) {
        countEl.textContent = count;
        
        // Add animation when count changes
        if (count > 0) {
          countEl.parentElement.classList.add('cart-has-items');
        } else {
          countEl.parentElement.classList.remove('cart-has-items');
        }
      }
    }

    document.getElementById('openCartBtn').addEventListener('click', openCart);
    function openCart(){
      renderCartItems();
      document.getElementById('cartModal').style.display = 'flex';
    }
    function closeCart(){ document.getElementById('cartModal').style.display = 'none'; }

    function renderCartItems(){
      const ct = document.getElementById('cartItems');
      const totalEl = document.getElementById('cartTotal');
      const cart = loadCart();
      ct.innerHTML = '';
      let total = 0;
      if(!cart.length){ 
        ct.innerHTML = '<div class="small muted-2">Cart is empty</div>'; 
        totalEl.textContent = '₵0'; 
        return; 
      }
      const fragment = document.createDocumentFragment();
      cart.forEach(item=>{
        const row = document.createElement('div'); 
        row.style.cssText = 'display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap';
        row.innerHTML = `<div style="min-width:0"><div style="font-weight:800">${escapeHtml(item.name)} <span class="small" style="color:#94a3b8">x${item.qty}</span></div><div class="small muted-2">₵${item.price} each</div></div><div style="display:flex;gap:8px;align-items:center"><button onclick="changeQty('${item.id}',-1)" style="padding:6px;border-radius:8px" aria-label="Decrease quantity">-</button><button onclick="changeQty('${item.id}',1)" style="padding:6px;border-radius:8px" aria-label="Increase quantity">+</button></div>`;
        fragment.appendChild(row);
        total += item.price * item.qty;
      });
      ct.appendChild(fragment);
      totalEl.textContent = '₵'+total;
    }

    function changeQty(id,delta){
      const cart = loadCart();
      const idx = cart.findIndex(i=>i.id===id);
      if(idx===-1) return;
      cart[idx].qty += delta;
      if(cart[idx].qty <= 0) cart.splice(idx,1);
      saveCart(cart);
      renderCartItems();
    }

    function clearCart(){ localStorage.removeItem(CART_KEY); updateCartUI(); renderCartItems(); }

    function checkoutCart(){
      const cart = loadCart();
      if(!cart.length){ showFeedback('Cart is empty'); return; }
      // create order object & store locally (demo)
      const total = cart.reduce((s,i)=>s+i.price*i.qty,0);
      const orders = loadOrders();
      const id = 'ORD-'+Date.now();
      const order = { id, items: cart, total, status:'pending', createdAt: new Date().toISOString() };
      orders.unshift(order);
      saveOrders(orders);
      clearCart();
      closeCart();
      showFeedback('Checkout successful — order recorded.');
      renderDashboard();
    }

    // -------------------------
    // ORDERS (localStorage)
    // -------------------------
    function loadOrders(){ try{ return JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]') }catch(e){ return [] } }
    function saveOrders(arr){ localStorage.setItem(ORDERS_KEY, JSON.stringify(arr)); }

    // single order form
    document.getElementById('placeOrderBtn').addEventListener('click', ()=>{
      const product = document.getElementById('o_product').value;
      const name = document.getElementById('o_name').value.trim();
      const phone = document.getElementById('o_phone').value.trim();
      const qty = Number(document.getElementById('o_qty').value) || 1;
      const addr = document.getElementById('o_address').value.trim();
      if(!name || !phone || !addr){ alert('Please fill name, phone and address.'); return; }
      const orders = loadOrders();
      const id = 'ORD-'+Date.now();
      const priceMap = { '12.5kg Cylinder — Refill':220, '5kg Cylinder — Refill':120, '37kg Cylinder — Commercial':680, 'Empty Exchange': 0 };
      const total = (priceMap[product]||100)*qty;
      orders.unshift({id, product, name, phone, qty, address:addr, total, status:'pending', createdAt:new Date().toISOString()});
      saveOrders(orders);
      document.getElementById('orderFeedback').textContent = 'Order recorded. We will contact you shortly.';
      setTimeout(()=>{ document.getElementById('orderFeedback').textContent = ''; },5000);
      renderDashboard();
    });

    // bulk form
    function fillBulk(pack){ document.getElementById('b_details').value = 'Interested in '+pack+' pack. Please quote.'; activateSection('bulk'); }
    function submitBulk(){ const company = document.getElementById('b_company').value.trim(); const contact = document.getElementById('b_contact').value.trim(); const details = document.getElementById('b_details').value.trim(); if(!company||!contact){ alert('Please enter company and contact'); return; } document.getElementById('bulkFeedback').textContent = 'Quote request sent. We will contact you.'; setTimeout(()=>document.getElementById('bulkFeedback').textContent='',5000); }

    // contact form
    function submitContact(){ const n=document.getElementById('c_name').value.trim(); const em=document.getElementById('c_email').value.trim(); const msg=document.getElementById('c_msg').value.trim(); if(!n||!em||!msg){ alert('Please fill the form'); return; } document.getElementById('contactFeedback').textContent = 'Message sent. We will respond soon.'; setTimeout(()=>document.getElementById('contactFeedback').textContent='',4000); }

    // one-click order
    function oneClickOrder(product,price){
      const orders = loadOrders();
      const id = 'ORD-'+Date.now();
      orders.unshift({id, product, qty:1, total:price, status:'pending', createdAt:new Date().toISOString()});
      saveOrders(orders);
      document.getElementById('quickFeedback').textContent = 'Order placed: '+product;
      setTimeout(()=>document.getElementById('quickFeedback').textContent='',4000);
      renderDashboard();
    }

    // WhatsApp helpers
    function openWhatsApp(){ window.open('https://wa.me/233201022153','_blank') }
    function openWhatsAppOrder(){
      const name = document.getElementById('o_name').value || '';
      const phone = document.getElementById('o_phone').value || '';
      const product = document.getElementById('o_product').value;
      const qty = document.getElementById('o_qty').value || 1;
      const addr = document.getElementById('o_address').value || '';
      if(!phone || !addr){ alert('Please fill phone and address first'); return; }
      const msg = `GasFill Order:%0AName:${encodeURIComponent(name)}%0APhone:${encodeURIComponent(phone)}%0AProduct:${encodeURIComponent(product)} x${qty}%0AAddress:${encodeURIComponent(addr)}`;
      window.open('https://wa.me/233201022153?text='+msg,'_blank');
    }
    function callHotline(){ window.location.href = 'tel:+233201022153'; }
    function composeEmail(){ window.location.href = 'mailto:support@gasfill.example'; }

    // -------------------------
    // ENHANCED DASHBOARD render - with rider info and tracking
    // -------------------------
    function renderDashboard(){
      const orders = loadOrders();
      const statOrdersEl = document.getElementById('statOrders');
      const statPendingEl = document.getElementById('statPending');
      const statRevenueEl = document.getElementById('statRevenue');
      const recentOrdersEl = document.getElementById('recentOrders');
      
      statOrdersEl.textContent = orders.length;
      const pending = orders.filter(o => ['pending', 'assigned', 'picked_up', 'in_transit', 'nearby'].includes(o.status)).length;
      statPendingEl.textContent = pending;
      const revenue = orders.reduce((s,o)=> s + (Number(o.total)||0), 0);
      statRevenueEl.textContent = '₵' + revenue.toLocaleString();
      
      recentOrdersEl.innerHTML = '';
      const fragment = document.createDocumentFragment();
      
      orders.slice(0,12).forEach(o=>{
        const div = document.createElement('div'); 
        div.className='order-row';
        
        const statusInfo = OrderStatusManager.getStatusDisplay(o.status);
        const timeAgo = getTimeAgo(new Date(o.createdAt));
        
        const left = document.createElement('div'); 
        left.innerHTML = `
          <div style="font-weight:800;display:flex;align-items:center;gap:8px">
            ${escapeHtml(o.product||'Cart order')} 
            <span class="small" style="color:#94a3b8">(${o.qty||1})</span>
            ${o.rider ? `<div class="rider-info">👤 ${o.rider.name}</div>` : ''}
          </div>
          <div class="small muted-2">${timeAgo} • ${o.total ? '₵' + o.total : 'Total pending'}</div>
          ${o.estimatedArrival ? `<div class="eta-badge">ETA: ${getTimeFromNow(new Date(o.estimatedArrival))}</div>` : ''}
        `;
        
        const right = document.createElement('div'); 
        right.style.cssText = 'display:flex;gap:8px;flex-wrap:wrap;align-items:center';
        
        const badge = document.createElement('div');
        badge.className = `badge ${statusInfo.class}`;
        badge.innerHTML = `<span class="status-icon ${o.status}"></span> ${statusInfo.icon} ${statusInfo.text}`;
        right.appendChild(badge);
        
        // Action buttons based on status
        if (o.status === 'nearby') {
          const callBtn = document.createElement('button'); 
          callBtn.textContent='Call Rider'; 
          callBtn.onclick = ()=> window.location.href = `tel:${o.rider?.phone || '+233201022153'}`;
          callBtn.setAttribute('aria-label', 'Call rider');
          right.appendChild(callBtn);
        } else if (o.status === 'delivered') {
          const rateBtn = document.createElement('button'); 
          rateBtn.textContent='Rate Order'; 
          rateBtn.onclick = ()=> openRatingModal(o.id);
          rateBtn.setAttribute('aria-label', 'Rate this order');
          right.appendChild(rateBtn);
        } else {
          const trackBtn = document.createElement('button'); 
          trackBtn.textContent='Track'; 
          trackBtn.onclick = ()=> openTrackingModal(o.id);
          trackBtn.setAttribute('aria-label', 'Track order');
          right.appendChild(trackBtn);
        }
        
        div.appendChild(left); 
        div.appendChild(right);
        fragment.appendChild(div);
      });
      
      recentOrdersEl.appendChild(fragment);
    }
    
    function getTimeAgo(date) {
      const now = new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMins / 60);
      const diffDays = Math.floor(diffHours / 24);
      
      if (diffMins < 1) return 'Just now';
      if (diffMins < 60) return `${diffMins}m ago`;
      if (diffHours < 24) return `${diffHours}h ago`;
      return `${diffDays}d ago`;
    }
    
    function getTimeFromNow(date) {
      const now = new Date();
      const diffMs = date - now;
      const diffMins = Math.floor(diffMs / 60000);
      
      if (diffMins < 1) return 'Now';
      if (diffMins < 60) return `${diffMins} min`;
      const diffHours = Math.floor(diffMins / 60);
      return `${diffHours}h ${diffMins % 60}m`;
    }
    
    function openTrackingModal(orderId) {
      const order = loadOrders().find(o => o.id === orderId);
      if (!order) return;
      
      alert(`Order Tracking:\n\nOrder: ${order.product || 'Multiple items'}\nStatus: ${OrderStatusManager.getStatusDisplay(order.status).text}\nRider: ${order.rider?.name || 'Not assigned'}\nETA: ${order.estimatedArrival ? getTimeFromNow(new Date(order.estimatedArrival)) : 'Calculating...'}`);
    }
    
    function openRatingModal(orderId) {
      const rating = prompt('Rate your order (1-5 stars):');
      if (rating && rating >= 1 && rating <= 5) {
        alert(`Thank you for your ${rating}-star rating! Your feedback helps us improve.`);
        // In real implementation, save rating to order
      }
    }

    function updateOrderStatus(id,status){
      const orders = loadOrders();
      const idx = orders.findIndex(o=>o.id===id);
      if(idx===-1) return;
      orders[idx].status = status; saveOrders(orders); renderDashboard();
    }

    // auto-rotate older orders statuses (demo) - optimized with debouncing
    const updateOrderStatuses = debounce(() => {
      const orders = loadOrders();
      let changed=false;
      orders.forEach(o=>{
        if(o.status === 'pending'){ o.status = 'accepted'; changed=true; }
        else if(o.status === 'accepted'){ o.status = 'delivered'; changed=true; }
      });
      if(changed){ 
        saveOrders(orders); 
        if(document.getElementById('dashboard').classList.contains('active')) renderDashboard(); 
      }
    }, 300);
    
    setInterval(updateOrderStatuses, 25000);

    // -------------------------
    // small utils & init - Enhanced
    // -------------------------
    function escapeHtml(s){ return (s+'').replace(/[&<>"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]||c)); }
    function showFeedback(text){ 
      const el = document.getElementById('cartFeedback'); 
      if(el){ 
        el.textContent = text; 
        setTimeout(()=>el.textContent='',3000) 
      } 
    }
    function addOrderToLocal(order){ const arr = loadOrders(); arr.unshift(order); saveOrders(arr); renderDashboard(); }

    // Enhanced initialization
    function initializeApp() {
      // Initialize data stores
      if(!localStorage.getItem(ORDERS_KEY)) saveOrders([]);
      if(!localStorage.getItem(CART_KEY)) saveCart([]);
      
      // Initialize UI
      updateCartUI();
      renderDashboard();
      
      // Start real-time features
      OrderStatusManager.initializeRealTimeUpdates();
      
      // Add cart indicator styles
      addCartStyles();
      
      console.log('🚀 GasFill Enhanced App Initialized');
    }
    
    function addCartStyles() {
      const style = document.createElement('style');
      style.textContent = `
        .cart-has-items .cart-count {
          background: var(--warning-500) !important;
          color: white !important;
          animation: pulse 2s infinite;
        }
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
      `;
      document.head.appendChild(style);
    }

    // helper to show messages - Enhanced
    function showMsg(msg, type = 'info'){ 
      const el = document.getElementById('cartFeedback'); 
      if(!el) return; 
      
      el.textContent = msg;
      el.className = `small cart-feedback-${type}`;
      setTimeout(()=>{
        el.textContent='';
        el.className = 'small';
      },3500); 
    }

    // small helpers called by HTML buttons - Enhanced
    window.addToCart = addToCartEnhanced;
    window.addToCartEnhanced = addToCartEnhanced;
    window.openWhatsApp = openWhatsApp;
    window.openWhatsAppOrder = openWhatsAppOrder;
    window.callHotline = callHotline;
    window.composeEmail = composeEmail;
    window.fillBulk = fillBulk;
    window.submitBulk = submitBulk;
    window.checkoutCart = checkoutCart;
    window.clearCart = clearCart;
    window.oneClickOrder = oneClickOrder;
    window.activateSection = activateSection;
    window.changeQty = changeQty;
    window.closeCart = closeCart;

    // preserve nav behavior if hash present
    if(location.hash){
      const h = location.hash.replace('#','');
      const mapping = { products:'products', order:'order', bulk:'bulk', safety:'safety', contact:'contact', orderNow:'orderNow', dashboard:'dashboard' };
      if(mapping[h]) activateSection(mapping[h]);
    }

    // -------------------------
    // Service Worker Registration
    // -------------------------
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => console.log('SW registered:', registration))
          .catch(err => console.log('SW registration failed:', err));
      });
    }

    // -------------------------
    // Handle window resize - close mobile menu if resized to desktop
    // -------------------------
    const handleResize = debounce(() => {
      if (window.innerWidth > 768) {
        mainNav.classList.remove('mobile-open');
        hamburgerBtn.classList.remove('active');
        hamburgerBtn.setAttribute('aria-expanded', 'false');
      }
    }, 250);

    window.addEventListener('resize', handleResize);
    
    // -------------------------
    // Initialize Enhanced App
    // -------------------------
    document.addEventListener('DOMContentLoaded', initializeApp);
    
    // Fallback initialization if DOMContentLoaded already fired
    if (document.readyState === 'loading') {
      // Wait for DOMContentLoaded
    } else {
      // DOM is already ready
      initializeApp();
    }
  </script>
</body>
</html>
